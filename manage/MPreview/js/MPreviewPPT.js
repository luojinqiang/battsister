/**
 * @name     MPreviewPPT.js
 * @desc     骞荤伅鐗囬瑙堛€�
 * @depend   jQuery 1.7+, jQuery.MouseWheel.js
 * @author   M.J
 * @date     2014-12-31
 * @URL      http://webjyh.com
 * @GitHub   https://github.com/webjyh/MPreview
 * @reutn    {jQuery}
 * @version  1.0.0
 *
 * @PS If you have any questions, please don't look for me, I don't know anything. thank you.
 */
(function(b){var a=function(d,c){this.config=b.extend({},this.defaults,c);this.elem=b(d);this.page=0;this.bout=0;this.btnOffset=0;this.length=0;this.data=[];this.W=[];this.DOM=this.__createDOM();this.S={width:this.elem.width(),height:this.elem.height(),viewWidth:this.DOM.mediaPlay.width(),viewHeight:this.DOM.mediaPlay.height()};this.__init()};a.prototype={defaults:{url:null,data:null,loadSize:5,scrollFix:5,minScrollWidth:20},__init:function(){var d=this,c=this.DOM;if(this.config.data&&this.config.data.length){this.__set(this.config.data).__create().__addEvent()}else{b.getJSON(this.config.url).done(function(e){if(e.code>0&&e.imgs.length){d.__set(e.imgs).__create().__addEvent()}}).fail(function(){alert("\u83b7\u53d6\u6570\u636e\u5931\u8d25")})}return this},__set:function(d){var c=this.DOM;this.data=d;this.length=d.length;c.pageInput.val("01");c.pageCount.children("em").text(this.__formatNumber(this.length));if(this.length>1){c.pageNext.addClass("current")}return this},__create:function(){if(!this.data.length){return false}b(document).off("mousemove");var g=0,e="",d=this.data.length,j=d>this.config.loadSize?this.config.loadSize:d,h=this.DOM,f=this.__getSize();for(;g<j;g++){var c=(typeof this.W[this.W.length-1]==="undefined"?0:this.W[this.W.length-1])+f.width;this.W.push(c);e+=a.tpl.replace("{src}",this.data.shift())}b(e).appendTo(h.mediaView).width(f.width).find("img").height(f.height);h.mediaView.css("width",this.W[this.W.length-1]);this.bout=this.W.length-1;this.__scrollBar();return this},__scrollBar:function(){var f=this.DOM,g=this,d=this.__getSize();if(this.length<2){f.scrollBar.hide();return false}var e=((d.width-this.config.scrollFix*2)/this.W[this.W.length-1])*d.width;this.btnOffset=(d.width-this.config.scrollFix*2-e)/this.bout;f.scrollBtn.width(e<=this.config.minScrollWidth?this.config.minScrollWidth:e);f.scrollBtn.css("left",this.btnOffset*this.page+this.config.scrollFix);var c=function(j){j=="up"?++g.page:--g.page;if(g.page<0){g.page=0}if(g.page>g.bout){g.page=g.bout}var h=(typeof g.W[g.page-1]==="undefined"?0:g.W[g.page-1]),i=g.page*g.btnOffset;f.mediaView.css("margin-left",-h);f.scrollBtn.css("left",i+(j=="up"?0:g.config.scrollFix));f.pageInput.val(g.__formatNumber(g.page+1));g.__createLastData()};f.mediaPlay.off("mousewheel").on("mousewheel",function(h){h.preventDefault();c(h.deltaY<0?"up":"down")});return this},__addEvent:function(){var c=this.DOM,f=this;var e=function(){if(f.page>0){c.arrowTop.stop(true,true).fadeIn()}if(f.page<f.length-1){c.arrowBottom.stop(true,true).fadeIn()}};var d=function(){c.arrowTop.stop(true,true).fadeOut();c.arrowBottom.stop(true,true).fadeOut()};c.scrollBtn.on("mousedown",function(g){f.__dragStart(g)});c.arrowUp.on("mouseover",e);c.arrowDown.on("mouseover",e);c.arrowUp.on("mouseout",d);c.arrowDown.on("mouseout",d);c.arrowTop.on("click",function(){f.__pageJump("up")});c.pagePrev.on("click",function(){f.__pageJump("up")});c.arrowBottom.on("click",function(){f.__pageJump("down")});c.pageNext.on("click",function(){f.__pageJump("down")});c.fullScreen.on("click",function(){f.__full()});c.mediaPlay.on("dblclick",function(){f.__full()});return this},__dragStart:function(e){var f=this,d=this.DOM,c=Math.floor(e.clientX-d.scrollBtn.offset().left);b(document).on("mousemove",function(g){f.__dragDrop(g,c)});b(document).off("mouseup").on("mouseup",function(){b(this).off("mousemove")})},__dragDrop:function(c,h){var k=this.DOM,l=this.__getSize(),d=parseInt(k.scrollBtn.css("left"),10),f=Math.floor(c.clientX-k.scrollBtn.offset().left-h+d),g=this.config.scrollFix,e=l.width-k.scrollBtn.outerWidth()-g;if(f<g){f=g}if(f>e){f=e}var j=Math.floor(f/this.btnOffset),i;this.page=j>this.bout?this.bout:j;i=(typeof this.W[this.page-1]==="undefined"?0:this.W[this.page-1]);k.mediaView.css("margin-left",-i);k.scrollBtn.css("left",f);k.pageInput.val(this.__formatNumber(this.page+1));this.__createLastData()},__pageJump:function(h){h=="up"?--this.page:++this.page;if(this.page<0){this.page=0}if(this.page>this.length-1){this.page=this.length-1}var f=this.DOM,e=this.__getSize(),i=typeof this.W[this.page-1]==="undefined"?0:this.W[this.page-1],d=this.page*this.btnOffset,c=this.config.scrollFix,g=e.width-f.scrollBtn.outerWidth()-c;if(d<c){d=c}if(d>g){d=g}f.pageInput.val(this.__formatNumber(this.page+1));f.mediaView.css("margin-left",-i);f.scrollBtn.css("left",d);this.__createLastData()},__full:function(d){var c=this.elem,k=this.DOM,g=this,j=k.fullScreen.hasClass("MPreview-exit"),e=b(window).outerHeight();if(d){j=false}var f={position:j?"static":"fixed",top:j?"auto":0,left:j?"auto":0,zIndex:j?"0":9999,width:j?this.S.width:"100%",height:j?this.S.height:e},h={overflow:j?"auto":"hidden",width:j?"auto":"100%",height:j?"auto":e};k.fullScreen[j?"removeClass":"addClass"]("MPreview-exit").attr("title",j?"\u5168\u5c4f":"\u53d6\u6d88\u5168\u5c4f");b("html").css(h);c.css(f);var i=k.mediaPlay.width();this.W=[];k.mediaView.children("div").each(function(){b(this).width(j?g.S.viewWidth:i);b(this).children("img").height(j?g.S.viewHeight:e);var l=(typeof g.W[g.W.length-1]==="undefined"?0:g.W[g.W.length-1])+(j?g.S.viewWidth:i);g.W.push(l)});k.mediaView.css("width",this.W[this.W.length-1]);k.mediaView.css("margin-left",-(typeof this.W[this.page-1]==="undefined"?0:this.W[this.page-1]));this.__scrollBar();if(j){b(document).off("keyup");b(window).off("resize")}else{b(document).on("keyup",function(l){if(l.which==27){g.__full()}});b(window).off("resize").on("resize",function(){g.__full(true)})}},__formatNumber:function(c){return c.toString().length<2?"0"+c:c},__createLastData:function(){var c=this.DOM;c.pagePrev[this.page>0?"addClass":"removeClass"]("current");c.pageNext[this.page<this.length-1?"addClass":"removeClass"]("current");if(this.page>=Math.floor(this.bout)-1){this.__create()}},__createDOM:function(){var c=this.elem,e={},d;e.wrap=b(a.template).appendTo(c);e.wrap.find("*").each(function(){var g=b(this).attr("class");if(g!==undefined&&g.toString().indexOf("MPreview")>-1){var f=g.replace(/icon /g,"").replace("MPreview-","");e[f]=b(this)}});return e},__getSize:function(){var c=this.DOM;return{width:c.mediaPlay.width(),height:c.mediaPlay.height()}}};a.tpl='<div><img src="{src}" /></div>';a.template='<div class="MPreview-box MPreview-ppt"><div class="tool-bar clefix"><ul class="clefix"><li><a href="javascript:void(0);" class="MPreview-fullScreen"><span>\u5168\u5c4f</span></a></li></ul></div><div class="MPreview-scrollBar"><div class="MPreview-scrollBtn"></div></div><div class="MPreview-mediaPlay"><div class="MPreview-mediaView"></div></div><div class="page-bar"><div class="page-bar-inner clefix"><a href="javascript:void(0);" class="MPreview-pagePrev"><span>\u4e0a\u4e00\u9875</span></a> <input type="text" name="page" class="MPreview-pageInput" value="0" disabled maxlength="5"> <span class="MPreview-pageCount">/&nbsp;&nbsp;<em>0</em></span> <a href="javascript:void(0);" class="MPreview-pageNext"><span>\u4e0b\u4e00\u9875</span></a></div></div><div class="MPreview-arrowUp"><div href="javascript:void(0);" class="MPreview-arrowTop"><span>\u4e0a\u4e00\u9875</span></div></div><div class="MPreview-arrowDown"><div href="javascript:void(0);" class="MPreview-arrowBottom"><span>\u4e0b\u4e00\u9875</span></div></div></div>';b.fn.MPreviewPPT=function(c){return this.each(function(){new a(this,c)})}})(jQuery);
/*!
 * jQuery Mousewheel 3.1.12
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){module.exports=a}else{a(jQuery)}}}(function(c){var d=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],k=("onwheel" in document||document.documentMode>=9)?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],h=Array.prototype.slice,j,b;if(c.event.fixHooks){for(var e=d.length;e;){c.event.fixHooks[d[--e]]=c.event.mouseHooks}}var f=c.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener){for(var m=k.length;m;){this.addEventListener(k[--m],l,false)}}else{this.onmousewheel=l}c.data(this,"mousewheel-line-height",f.getLineHeight(this));c.data(this,"mousewheel-page-height",f.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var m=k.length;m;){this.removeEventListener(k[--m],l,false)}}else{this.onmousewheel=null}c.removeData(this,"mousewheel-line-height");c.removeData(this,"mousewheel-page-height")},getLineHeight:function(m){var i=c(m),n=i["offsetParent" in c.fn?"offsetParent":"parent"]();if(!n.length){n=c("body")}return parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(i){return c(i).height()},settings:{adjustOldDeltas:true,normalizeOffset:true}};c.fn.extend({mousewheel:function(i){return i?this.bind("mousewheel",i):this.trigger("mousewheel")},unmousewheel:function(i){return this.unbind("mousewheel",i)}});function l(i){var o=i||window.event,u=h.call(arguments,1),w=0,q=0,p=0,t=0,s=0,r=0;i=c.event.fix(o);i.type="mousewheel";if("detail" in o){p=o.detail*-1}if("wheelDelta" in o){p=o.wheelDelta}if("wheelDeltaY" in o){p=o.wheelDeltaY}if("wheelDeltaX" in o){q=o.wheelDeltaX*-1}if("axis" in o&&o.axis===o.HORIZONTAL_AXIS){q=p*-1;p=0}w=p===0?q:p;if("deltaY" in o){p=o.deltaY*-1;w=p}if("deltaX" in o){q=o.deltaX;if(p===0){w=q*-1}}if(p===0&&q===0){return}if(o.deltaMode===1){var v=c.data(this,"mousewheel-line-height");w*=v;p*=v;q*=v}else{if(o.deltaMode===2){var n=c.data(this,"mousewheel-page-height");w*=n;p*=n;q*=n}}t=Math.max(Math.abs(p),Math.abs(q));if(!b||t<b){b=t;if(a(o,t)){b/=40}}if(a(o,t)){w/=40;q/=40;p/=40}w=Math[w>=1?"floor":"ceil"](w/b);q=Math[q>=1?"floor":"ceil"](q/b);p=Math[p>=1?"floor":"ceil"](p/b);if(f.settings.normalizeOffset&&this.getBoundingClientRect){var m=this.getBoundingClientRect();s=i.clientX-m.left;r=i.clientY-m.top}i.deltaX=q;i.deltaY=p;i.deltaFactor=b;i.offsetX=s;i.offsetY=r;i.deltaMode=0;u.unshift(i,w,q,p);if(j){clearTimeout(j)}j=setTimeout(g,200);return(c.event.dispatch||c.event.handle).apply(this,u)}function g(){b=null}function a(m,i){return f.settings.adjustOldDeltas&&m.type==="mousewheel"&&i%120===0}}));